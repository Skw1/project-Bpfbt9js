{"version":3,"file":"commonHelpers.js","sources":["../src/img/tomatto.png","../src/img/icons.svg#shadow-icon","../src/js/totalcartsum.js","../src/js/cart.js"],"sourcesContent":["export default \"__VITE_ASSET__122fc994__\"","export default \"__VITE_ASSET__cb42c3c5__$_#shadow-icon__\"","import refsAPI from './refs.js';\nimport fetchApi from './fetchApi.js';\nimport localStorageApi from './localStorageApi.js';\nimport closeIcon from '../img/icons.svg#close-icon';\nimport { drawHeaderCartNumber } from './discount.js';\nimport ModalFilter from './modal/ModalFilter.js';\nimport tomattoIcon from '../img/tomatto.png';\nimport shadowIcon from '../img/icons.svg#shadow-icon';\n\nasync function totalCartSum() {\n  let cartIsEmpty = true;\n  const frontEnd = new refsAPI();\n  frontEnd.bigCartNumber.textContent = 'CART (0)';\n  var productsToDraw = [];\n  var cartSum = 0;\n  //load cart with products\n  const cart = localStorageApi.loadCart();\n\n  //get  info for each product in cart\n  if ('products' in cart) {\n    const products = await Promise.all(\n      cart.products.map(product => {\n        return fetchApi.product(product.productId);\n      })\n    );\n    products.forEach(product => {\n      cartIsEmpty = false;\n      //add totall product price to totall cart sum\n      cartSum =\n        cartSum +\n        product.price * cart.products[products.indexOf(product)].amount;\n      // console.log(typeof cart.products[products.indexOf(product)].amount);\n      productsToDraw.push(`\n            \n          <li class=\"cart-product\" data-productId=\"${product._id}\">\n            <div class=\"cart-product-img\">\n              <img class=\"card-img\"\n                src=\"${product.img}\"\n                alt=\"${product.name}\"\n              />\n            </div>\n\n            <div class=\"cart-product-card\">\n              <div class=\"cart-product-name-container\">\n                <h3 class=\"cart-product-name\">${product.name}</h3>\n                <button data-productId=\"${product._id}\" type=\"button\" class=\"cart-product-delete-btn js-cart-prod-del\">\n                <svg class=\"cart-icon-close js-cart-prod-del\" data-productId=\"${product._id}\" width=\"18\" height=\"18\">\n                    <use class=\"js-cart-prod-del\" data-productId=\"${product._id}\" href=\"${closeIcon}#close-icon\"></use>\n                    </svg>\n                </button>\n              </div>\n\n                <div class=\"cart-product-info\">\n                  <p class=\"cart-category-title\">\n                    Category:\n                    <span class=\"cart-category-name\">${product.category}</span>\n                  </p>\n                  <p class=\"cart-product-size\">\n                    Size: <span class=\"cart-product-size-value\">${product.size}</span>\n                  </p>\n                </div>\n                  <div class=\"cart-product-price\" >\n                    <span class=\"cart-product-span\">$${product.price}</span>\n                  </div>\n                \n            </div>\n          </li>\n          <div class=\"divider\"></div>\n          `);\n    });\n    frontEnd.bigCartNumber.textContent = 'CART (' + cart.products.length + ')';\n  }\n  if (cartIsEmpty) {\n    frontEnd.deleteAllBtn.style.display = 'none';\n    frontEnd.cartEmptyContainer.style.display = 'flex';\n    frontEnd.totalCartSum.textContent = '$0';\n    frontEnd.cartContainer.innerHTML = '';\n  } else {\n    frontEnd.deleteAllBtn.style.display = 'flex';\n    frontEnd.cartEmptyContainer.style.display = 'none';\n    frontEnd.cartContainer.innerHTML = productsToDraw.join('');\n    frontEnd.totalCartSum.textContent = '$' + cartSum.toFixed(2);\n  }\n\n  // delete one product\n  // if ('products' in cart && cart.products.length) {\n  //   document\n  //     .querySelector('.js-cart-prod-del')\n  //     .addEventListener('click', event => {\n  //       const frontEnd = new refsAPI();\n  //       const btn = event.target.closest('.js-cart-prod-del');\n  //       const id = btn.dataset.productid;\n\n  //       const prodIdx = cart.products.findIndex(\n  //         product => product.productId === id\n  //       );\n  //       if (prodIdx !== -1) {\n  //         cart.products.splice(prodIdx, 1);\n  //       }\n\n  //       localStorageApi.saveCart(cart);\n  //       totalCartSum();\n  //       console.log(frontEnd);\n  //       frontEnd.cartEmptyContainer.style.display = 'block';\n  //     });\n  // }\n\n  // delete one product\n  frontEnd.cartContainer.addEventListener('click', event => {\n    const btn = event.target.closest('.js-cart-prod-del');\n    if (btn) {\n      const id = btn.dataset.productid;\n      const prodIdx = cart.products.findIndex(\n        product => product.productId === id\n      );\n\n      if (prodIdx !== -1) {\n        cart.products.splice(prodIdx, 1);\n        localStorageApi.saveCart(cart);\n        totalCartSum();\n      }\n    }\n  });\n}\n\nasync function checkout(event) {\n  event.preventDefault();\n  const frondEnd = new refsAPI();\n  const cart = localStorageApi.loadCart();\n  if (frondEnd.cartEmail.value.trim().length !== 0) {\n    if ('products' in cart) {\n      if (cart.products.length !== 0) {\n        try {\n          cart.email = frondEnd.cartEmail.value.trim();\n          const message = await fetchApi.order(cart);\n          localStorageApi.deleteCart();\n          drawHeaderCartNumber();\n          totalCartSum();\n          ModalFilter._modalImg.style.display = 'none';\n          ModalFilter._modal.innerHTML = `\n        <div class=\"modal-inner\">\n          <div class=\"moal__food-tomatto--wrap\">\n          <svg class=\"moal__food-tomatto--shadow\">\n          <use href=\"${shadowIcon}\"></use>\n        </svg>\n            <img\n              class=\"modal__food-tomatto\"\n              src=\"${tomattoIcon}\"\n              alt=\"Кошик з фруктамі\"\n            />\n            \n          </div>\n          <div class=\"modal__title--wrap-success\">\n            <p class=\"modal__title--success\">ORDER SUCCESS</p>\n          </div>\n          <div class=\"modal__description--wrap modal__description--wrap-success\">\n            <p class=\"modal__description modal__description--success\">\n              Thank you for shopping at Food Boutique. Your order has been\n              received and is now being freshly prepared just for you! Get ready\n              to indulge in nourishing goodness, delivered right to your doorstep.\n              We're thrilled to be part of your journey to better health and\n              happiness.\n            </p>\n          </div>\n        </div>`;\n          ModalFilter.open();\n        } catch (error) {\n          alert('Check email!');\n        }\n      } else {\n        alert('empty cart2!');\n      }\n    } else {\n      alert('empty cart1!');\n    }\n  } else {\n    alert('empty email!');\n  }\n}\n\nexport { totalCartSum, checkout };\n","import localStorageApi from './localStorageApi.js';\nimport { form } from '/js/footer-modal.js';\nimport { postEmail } from '/js/footer-modal.js';\n\nimport { totalCartSum, checkout } from './totalcartsum.js';\nimport { drawHeaderCartNumber } from './discount.js';\nimport refsAPI from './refs.js';\n\ndrawHeaderCartNumber();\ntotalCartSum();\n\nconst frondEnd = new refsAPI();\nconst CART = document.querySelector('.cart-amount');\nfrondEnd.buttonCheckout.addEventListener('click', checkout);\n\nform.addEventListener('submit', postEmail);\n\n// delete all cart\nfrondEnd.deleteAllBtn.addEventListener('click', event => {\n  if (event.target.classList.contains('js-delete-all')) {\n    localStorageApi.deleteCart();\n    totalCartSum();\n    CART.textContent = 'CART (0)';\n  }\n});\n\n// delete one product\nfrondEnd.cartContainer.addEventListener('click', event => {\n  let cart = localStorageApi.loadCart();\n\n  if (event.target.classList.contains('js-cart-prod-del')) {\n    const id = event.target.dataset.productid;\n    const prodIdx = cart.products.findIndex(\n      product => product.productId === id\n    );\n    if (prodIdx !== -1) {\n      cart.products.splice(prodIdx, 1);\n    }\n\n    localStorageApi.saveCart(cart);\n    totalCartSum();\n  }\n});\n"],"names":["tomattoIcon","shadowIcon","totalCartSum","cartIsEmpty","frontEnd","refsAPI","productsToDraw","cartSum","cart","localStorageApi","products","product","fetchApi","closeIcon","event","btn","id","prodIdx","checkout","frondEnd","message","drawHeaderCartNumber","ModalFilter","CART","form","postEmail"],"mappings":"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"}